# Server
PORT=3000
BASE_URL="http://localhost:3000"
# Hosted checkout base URL for checkout_url (e.g. https://pay.fluxapay.com). Falls back to BASE_URL.
PAY_CHECKOUT_BASE="${BASE_URL}"
PAYMENT_RATE_LIMIT_PER_MINUTE=5

# Database
DATABASE_URL="postgresql://postgres:postgres@localhost:5432/fluxapay?schema=public"

# Docker Compose DB settings (optional, defaults shown)
POSTGRES_USER=postgres
POSTGRES_PASSWORD=postgres
POSTGRES_DB=fluxapay

# JWT
JWT_SECRET="your-jwt-secret-here"

# Cloudinary (for KYC document uploads)
CLOUDINARY_CLOUD_NAME="your-cloud-name"
CLOUDINARY_API_KEY="your-api-key"
CLOUDINARY_API_SECRET="your-api-secret"

# Email (Resend)
RESEND_API_KEY="re_your_resend_api_key_here"

# Webhook
WEBHOOK_SECRET="your-webhook-secret-here"

# Stellar
STELLAR_HORIZON_URL="https://horizon-testnet.stellar.org"
STELLAR_NETWORK_PASSPHRASE="Test SDF Network ; September 2015"
FUNDER_SECRET_KEY="your-funder-secret-key-here"
USDC_ISSUER_PUBLIC_KEY="GBBD47IF6LWK7P7MDEVSCWT73IQIGCEZHR7OMXMBZQ3ZONN2T4U6W23Y" # Example Testnet Asset Issuer for testing

# ─── HD Wallet & KMS Configuration ─────────────────────────────────────────────

# KMS Provider: "local" (development) or "aws" (production)
KMS_PROVIDER="local"

# Local KMS (Development Only)
# Encryption passphrase for local KMS (change this in production-like environments)
KMS_ENCRYPTION_PASSPHRASE="your-strong-passphrase-here"

# Encrypted master seed (generated by KMS provider)
# To generate: Use the KMS CLI tool or encrypt your seed manually
KMS_ENCRYPTED_MASTER_SEED="your-encrypted-seed-here"

# Legacy: Plain-text master seed (DEPRECATED - for backward compatibility only)
# WARNING: This is insecure! Migrate to KMS_ENCRYPTED_MASTER_SEED
# HD_WALLET_MASTER_SEED="your-plain-master-seed-here"

# AWS KMS (Production)
# Required when KMS_PROVIDER=aws
AWS_KMS_KEY_ID="arn:aws:kms:us-east-1:123456789012:key/12345678-1234-1234-1234-123456789012"
AWS_REGION="us-east-1"
# AWS credentials should be provided via IAM roles or environment variables:
# AWS_ACCESS_KEY_ID, AWS_SECRET_ACCESS_KEY (not recommended to store in .env)

# Soroban Smart Contracts
SOROBAN_RPC_URL="https://soroban-testnet.stellar.org"
SOROBAN_NETWORK_PASSPHRASE="Test SDF Network ; September 2015"
MERCHANT_REGISTRY_CONTRACT_ID="C..."
ADMIN_SECRET_KEY="S..."

# ─── Settlement Batch ──────────────────────────────────────────────────────────

# Exchange / payout partner: "yellowcard" | "anchor" | "mock" (default: mock)
EXCHANGE_PARTNER="mock"

# Yellow Card (https://yellowcard.io) — required when EXCHANGE_PARTNER=yellowcard
YELLOWCARD_API_KEY="yc_your_api_key_here"
YELLOWCARD_API_URL="https://api.yellowcard.io"

# Anchor (https://anchorusd.com) — required when EXCHANGE_PARTNER=anchor
ANCHOR_API_KEY="anc_your_api_key_here"
ANCHOR_API_URL="https://api.anchorusd.com"

# Settlement fee (percentage charged by FluxaPay, default: 2)
SETTLEMENT_FEE_PERCENT="2"

# Cron expression for settlement batch (UTC). Default: daily at midnight UTC.
# Examples:
#   "0 0 * * *"   → every day at 00:00 UTC (default)
#   "0 0 * * 1"   → every Monday at 00:00 UTC (weekly)
#   "*/5 * * * *" → every 5 minutes (testing only)
SETTLEMENT_CRON="0 0 * * *"

# On-chain payment monitor: how often to poll Stellar for incoming USDC (default: every 2 min).
# Automated pulls for pending payments; merchant-triggered charges use the payment creation API.
PAYMENT_MONITOR_CRON="*/2 * * * *"

# Billing cycle: subscription renewals (default: daily at 01:00 UTC).
BILLING_CRON="0 1 * * *"

# Max number of Payment rows processed per batch run (prevents OOM on huge datasets)
SETTLEMENT_BATCH_LIMIT="500"

# Set to "true" to disable all cron jobs (useful in test/CI environments)
DISABLE_CRON="false"

# Internal admin secret for /api/admin/* endpoints (X-Admin-Secret header)
ADMIN_INTERNAL_SECRET="your-strong-internal-secret-here"

